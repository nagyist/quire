{% assign contributorList = nil %}

{% if contributorType == "all" %}
  {% assign contributorList = contributors %}
{% else %}
  {% assign contributorList = contributors | where: "type", "contributorType" %}
{% endif %}

{% if contributorList %}
  {% if listType == "string" %}
    {% for contributor in contributorList %}
      {%- if forLoop.length == 1 -%}
        <span class="quire-contributor">{% render "name-check", contributor: contributor %}</span>
      {%- elsif forLoop.index | plus: 1 == forLoop.length -%}
        <span class="quire-contributor"> and {% render "name-check", contributor: contributor %}</span>
      {%- else -%}
        {%- if forLoop.length == 2 -%}
          <span class="quire-contributor">{% render "name-check", contributor: contributor %} </span>
        {%- else -%}
          <span class="quire-contributor">{% render "name-check", contributor: contributor %}, </span>
        {%- endif -%}
      {%- endif -%}
    {% endfor %}
  {% elsif listType == "list" %}
    <ul>
      {% for contributor in contributorList -%}
        <li class="quire-contributor">{% render "name-check", contributor: contributor %}</li>
      {%- endfor %}
    </ul>
  {% elsif listType == "list-plus" %}
    <ul>
      {% for contributor in contributorList -%}
        <li class="quire-contributor">
          {%- render "name-check", contributor: contributor -%}
          {% if title or affiliation %}
            {%- render "title", title: title, affiliation: affiliation -%}
          {% elsif id %}
            {% for contributorById in site.data.publication.contributor | where: "id", id %}
              {%- template "title", title: contributorById.title, affiliation: contributorById.affiliation %}
            {% endfor %}
          {% endif %}
        </li>
      {%- endfor %}
    </ul>
  {% endif %}
{% endif %}
